from functools import lru_cache
import math

@lru_cache(maxsize=None)
def divisor_sum(n):
    total = 1
    if n == 1:
        return 0

    root = int(math.sqrt(n))
    for i in range(2, root+1):
        if n % i == 0:
            total += i
            other = n // i
            if other != i:
                total += other

    return total


def amicable(n):
    pair = divisor_sum(n)
    if pair == n:
        return False
    return divisor_sum(pair) == n


total = 0
for i in range(1, 10000):
    if amicable(i):
        total += i

print(total)
#highly optimised code, using caching
